(()=>{"use strict";var t={660:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.events={}}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}emit(t,...e){if(this.events[t])for(const i of this.events[t])i(...e)}}},296:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Colors=e.EntityType=e.Environment=e.Movement=e.Vector=e.Renderer=e.Camera=e.Collision=e.Circle=e.Entity=e.System=void 0;const o=s(i(510));e.System=o.default;const n=s(i(845)),r=s(i(404)),a=s(i(694));e.Entity=a.default;const l=s(i(149));e.Circle=l.default;const h=s(i(940));e.Camera=h.default;const c=s(i(544));e.Renderer=c.default;const d=s(i(91));e.Vector=d.default;const u=i(184);Object.defineProperty(e,"Movement",{enumerable:!0,get:function(){return u.Movement}}),Object.defineProperty(e,"Environment",{enumerable:!0,get:function(){return u.Environment}}),Object.defineProperty(e,"EntityType",{enumerable:!0,get:function(){return u.EntityType}}),Object.defineProperty(e,"Colors",{enumerable:!0,get:function(){return u.Colors}});const f="undefined"!=typeof window;e.Collision={CollisionResolver:n.default,SpatialHashGrid:r.default},f&&(window.Kinetics={System:o.default,Entity:a.default,Circle:l.default,Collision:e.Collision,Camera:h.default,Renderer:c.default,Vector:d.default,Movement:u.Movement,Environment:u.Environment,EntityType:u.EntityType,Colors:u.Colors})},510:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(184),n=i(2),r=s(i(404)),a=s(i(845)),l=s(i(940)),h=s(i(544)),c=s(i(660));class d extends c.default{get momentum(){let t=0;for(const e of this.entities)e&&(t+=e.velocity.magnitude*e.mass+Math.abs(e.angularVelocity*e.inertia)*e.mass);return t}get kineticEnergy(){let t=0;for(const e of this.entities)e&&(t+=.5*e.mass*(e.velocity.magnitude*e.velocity.magnitude));return t}get nextId(){const t=this.entities.indexOf(void 0);return-1!==t?t:this.entities.length}constructor(t){var e,i;if(super(),this.width=null,this.height=null,this.friction=.1,this.gravity=0,this.CollisionResolver=new a.default,this.entities=[],this.verbose=!1,this.tick=0,this.tickRate=0,this.environment=o.Environment.Browser,this.performance={worldUpdateRate:0,memoryUsage:0},this.environment="undefined"==typeof window?o.Environment.Node:o.Environment.Browser,this.config=t,this.width=(null===(e=t.dimensions)||void 0===e?void 0:e.x)||null,this.height=(null===(i=t.dimensions)||void 0===i?void 0:i.y)||null,this.width&&!this.height||this.height&&!this.width)throw new n.ConfigurationError("Both dimensions must be specified for the system.");if(this.friction=void 0===t.friction?.1:t.friction,this.gravity=void 0===t.gravity?0:t.gravity,this.camera=new l.default(t.camera||{},this),this.renderer=new h.default(t.render,this),this.verbose=t.verbose||!1,!t.collisionInfo)throw new n.ConfigurationError("Collision information must be specified for the system.");this.CollisionManager=new r.default(this,t.collisionInfo.cellSize||12),this.verbose&&console.log("[PHYSICS]: Engine started."),this.environment!==o.Environment.Browser||!1===t.useRAF?(this.tickRate=t.tickRate||60,setInterval(this.update.bind(this),1e3/this.tickRate)):requestAnimationFrame(this.update.bind(this))}setCollisionEngine(t){this.CollisionManager=t}update(){var t;const e=performance.now();this.CollisionManager.clear();for(const t of this.entities){if(!t)return;this.CollisionManager.insert(t.bounds.min.x,t.bounds.min.y,t.hitbox.x,t.hitbox.y,t.id),t.update()}this.CollisionManager.query(),this.tick++,this.performance.worldUpdateRate=performance.now()-e,this.performance.memoryUsage=this.environment===o.Environment.Browser?(null===(t=performance.memory)||void 0===t?void 0:t.usedJSHeapSize)/1024/1024:process.memoryUsage().heapUsed/1024/1024,this.environment===o.Environment.Browser&&!1!==this.config.useRAF&&requestAnimationFrame(this.update.bind(this))}addEntity(t){const e=this.nextId;return t.id=e,this.entities[e]=t,this.emit("entityCreate",t),t}removeEntity(t){return this.entities[t.id]=void 0,this.emit("entityDelete",t),t}}e.default=d},845:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=i(184);class o{detect(t,e){if(t.components.length&&e.components.length)for(const i of t.components)for(const t of e.components){if(this.detectSimple(i,t))break}else if(t.components.length||e.components.length){const i=t.components.length?t:e,s=t.components.length?e:t;for(const t of i.components){if(this.detectSimple(t,s))break}}else this.detectSimple(t,e)}detectSimple(t,e){if(t.type===s.EntityType.Circle&&e.type===s.EntityType.Circle)return this.detectCircleCircle(t,e);if(t.type===s.EntityType.Circle||e.type===s.EntityType.Circle){const i=t.type===s.EntityType.Circle?t:e,o=t.type===s.EntityType.Circle?e:t;return this.detectCirclePolygon(i,o)}let i,n=1/0;const r=t.vertices,a=e.vertices,l=r.length+a.length;for(let t=0;t<l;t++){let e;if(e=t<r.length?r[t].clone.subtract(r[(t+1)%r.length]).orthogonal.normalize():a[t-r.length].clone.subtract(a[(t+1)%a.length]).orthogonal.normalize(),0===e.x&&0===e.y)continue;const[s,l]=o.project(e,r),[h,c]=o.project(e,a),d=Math.min(l,c)-Math.max(s,h);if(d<=0)return!1;d<n&&(i=e,n=d)}return!!i&&(this.resolve(t.parent||t,e.parent||e,Math.max(t.elasticity,e.elasticity),n,i),t.lastCollisionFrame=t.tick,e.lastCollisionFrame=e.tick,!0)}detectCirclePolygon(t,e){const i=e.vertices;let s,n=1/0;for(let e=0;e<i.length;e++){const r=i[e],a=i[(e+1)%i.length].clone.subtract(r).orthogonal.normalize();if(0===a.x&&0===a.y)continue;const[l,h]=o.project(a,i),c=t.position.dot(a),d=Math.min(h,c+t.radius)-Math.max(l,c-t.radius);if(d<=0)return!1;d<n&&(n=d,s=a)}return!!s&&(this.resolve(t.parent||t,e.parent||e,Math.max(t.elasticity,e.elasticity),n,s),t.lastCollisionFrame=t.tick,e.lastCollisionFrame=e.tick,!0)}detectCircleCircle(t,e){const i=t.position.distance(e.position),s=t.radius+e.radius-i,o=t.position.clone.subtract(e.position).normalize();return!(s<=0)&&(!!o&&(this.resolve(t.parent||t,e.parent||e,Math.max(t.elasticity,e.elasticity),s,o),t.lastCollisionFrame=t.tick,e.lastCollisionFrame=e.tick,!0))}static project(t,e){let i=1/0,s=-1/0;for(const o of e){const e=o.dot(t);i=Math.min(i,e),s=Math.max(s,e)}return[i,s]}resolve(t,e,i,s,o){var n,r,a,l,h,c,d,u;null===(r=(n=t.hooks).preResolve)||void 0===r||r.call(n,e),null===(l=(a=e.hooks).preResolve)||void 0===l||l.call(a,t),t.position.dot(o)<e.position.dot(o)&&o.scale(-1);const f=t.velocity,m=e.velocity,g=t.mass,y=e.mass,p=-(1+i)*f.clone.subtract(m).dot(o)/(1/g+1/y),v=o.clone.scale(p);t.static||t.velocity.add(v.clone.scale(1/g)),e.static||e.velocity.subtract(v.clone.scale(1/y)),t.static||e.static||(t.angularVelocity-=1/t.inertia*t.position.clone.subtract(e.position).cross(v),e.angularVelocity-=1/e.inertia*t.position.clone.subtract(e.position).cross(v));const w=o.clone.scale(s/(1/g+1/y));t.static||t.updatePosition(w.clone.scale(1/g)),e.static||e.updatePosition(w.clone.scale(-1/y)),null===(c=(h=t.hooks).postResolve)||void 0===c||c.call(h,e),null===(u=(d=e.hooks).postResolve)||void 0===u||u.call(d,t)}}e.default=o},404:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),o=(t,e)=>t+46340*e;e.default=class{constructor(t,e){if(this.cells=new Map,!Number.isInteger(e)||e>=32)throw new s.ConfigurationError("Could not initialize SpatialHashGrid: Cell size must be an integer value less than 32.");this.system=t,this.cellSize=e}insert(t,e,i,s,n){const r=t>>this.cellSize,a=e>>this.cellSize,l=t+i>>this.cellSize,h=e+s>>this.cellSize;for(let t=r;t<=l;t++)for(let e=a;e<=h;e++){const i=o(t,e);this.cells.get(i)||this.cells.set(i,[]),this.cells.get(i).push(n)}}query(){for(const t of this.cells.values()){const e=t.length;if(!(e<2))for(let i=0;i<e;i++)for(let s=i+1;s<e;s++){const e=this.system.entities[t[i]],o=this.system.entities[t[s]];e.sleeping&&o.sleeping||this.system.CollisionResolver.detect(e,o)}}}clear(){this.cells.clear()}}},694:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(184),n=i(2),r=s(i(91)),a=i(296);class l{get sleeping(){return this.tick-this.lastCollisionFrame>5&&Math.abs(this.velocity.x)<this.sleepThreshold&&Math.abs(this.velocity.y)<this.sleepThreshold&&Math.abs(this.angularVelocity)<this.sleepThreshold}get hitbox(){return this.bounds.max.subtract(this.bounds.min)}get inertia(){if(this.static)return 0;const t=this.vertices;let e=0;for(let i=0;i<t.length;i++){const s=t[i],o=t[(i+1)%t.length];e+=s.cross(s)+o.cross(o)+s.cross(o)}return Math.abs(e)/12}get angle(){return this._angle}set angle(t){if(t===this._angle||!1===this.info.rotate)return;const e=t-this._angle,i=Math.cos(e),s=Math.sin(e);this._angle=t;for(let t=0;t<this.vertices.length;t++){const e=this.vertices[t].x-this.position.x,o=this.vertices[t].y-this.position.y,n=e*i-o*s,r=e*s+o*i;this.vertices[t].x=n+this.position.x,this.vertices[t].y=r+this.position.y}}get bounds(){let t=1/0,e=1/0,i=-1/0,s=-1/0;for(const o of this.vertices){const n=o.x,r=o.y;t=t>n?n:t,e=e>r?r:e,i=i<n?n:i,s=s<r?r:s}return void 0===this.position&&(this.position=new r.default((t+i)/2,(e+s)/2)),{min:new r.default(t,e),max:new r.default(i,s)}}get area(){let t=0;for(let e=0;e<this.vertices.length;e++)t+=this.vertices[e].cross(this.vertices[(e+1)%this.vertices.length]);return Math.abs(t/2)}constructor(t,e){if(this.tick=0,this.lastCollisionFrame=0,this.sleepThreshold=-1,this.type=o.EntityType.Polygon,this.velocity=new r.default(0,0),this.acceleration=new r.default(0,0),this.angularVelocity=0,this.angularSpeed=0,this.components=[],this.parent=null,this.hooks={},this._angle=0,this.info=t,this.system=e,this.vertices=this.initializeVertices(t),this.bounds,this.mass=t.mass,this.speed=t.speed,this.angularSpeed=t.angularSpeed||0,this.elasticity=Math.max(0,t.elasticity)||0,this.static=!!t.static,this.sleepThreshold=void 0===t.sleepThreshold?-1:t.sleepThreshold,this.mass||0===this.mass||(this.mass=1,console.warn("[SYSTEM]: Entity mass defaulted to 1 due to a zero quantity being provided.")),this.configure(t.render||{}),this.hooks=t.hooks||{},!e)throw new n.ConfigurationError("No system was provided for the entity.")}initializeVertices(t){if(!t.form)throw new n.ConfigurationError("No form was provided for the entity.");let e=[];if(t.form.components)for(const i of t.form.components){if(i.form.components)throw new n.ConfigurationError("Components cannot have components.");const t=i.radius?new a.Circle(i,this.system):new l(i,this.system);t.parent=this,this.components.push(t),e.push(...t.vertices)}else if(t.form.vertices)e=t.form.vertices;else{if(!t.form.sides)throw new n.ConfigurationError("No form was provided for the entity.");{const i=[],s=t.form.radius;if(!s)throw new n.ConfigurationError("No radius was provided for the entity.");const o=2*Math.PI/t.form.sides;for(let e=0;e<t.form.sides;e++){const n=o*e+(t.form.rotation||0);i.push(r.default.toCartesian(s,n).add(t.form.offset||{x:0,y:0}))}e=i}}return e}configure(t){this.rendering={strokeColor:t.strokeColor,fillColor:t.fillColor,strokeWidth:t.strokeWidth||1,glowIntensity:t.glowIntensity,glowColor:t.glowColor,hooks:t.hooks||{}}}rotate(...t){for(const e of t)switch(e){case o.Movement.Up:this.angularVelocity+=this.angularSpeed;break;case o.Movement.Down:case o.Movement.Left:this.angularVelocity-=this.angularSpeed;break;case o.Movement.Right:this.angularVelocity+=this.angularSpeed;break;default:console.error("[SYSTEM]: Invalid angular movement key.")}}move(...t){for(const e of t)switch(e){case o.Movement.Up:this.acceleration.y+=this.speed;break;case o.Movement.Down:this.acceleration.y-=this.speed;break;case o.Movement.Left:this.acceleration.x-=this.speed;break;case o.Movement.Right:this.acceleration.x+=this.speed;break;default:console.error("[SYSTEM]: Invalid movement key.")}this.acceleration.normalize().scale(this.speed),this.velocity.add(this.acceleration)}update(){this.static&&(this.velocity.x=this.velocity.y=this.angularVelocity=0),this.system.gravity&&!this.static&&(this.velocity.y-=this.system.gravity),this.velocity.scale(1-this.system.friction),this.angularVelocity*=1-this.system.friction,this.updatePosition(this.velocity),this.angle+=this.angularVelocity/100,this.acceleration.scale(0),this.tick++,this.system.emit("entityUpdate",this)}updatePosition(t){if(this.static)return;const e=this.system.width,i=this.system.height;if(e&&i){const s=e/2,o=i/2;this.position.x+t.x>s?t.x=s-this.position.x:this.position.x+t.x<-s&&(t.x=-s-this.position.x),this.position.y+t.y>o?t.y=o-this.position.y:this.position.y+t.y<-o&&(t.y=-o-this.position.y)}this.position.add(t);for(const e of this.vertices)e.add(t)}determineColors(){let t,e;const i=this;return i.rendering.strokeColor&&(t=i.rendering.strokeColor),i.rendering.fillColor&&(e=i.rendering.fillColor),t||e||(t=o.Colors.Black),{stroke:t,fill:e}}render(t){const{stroke:e,fill:i}=this.determineColors();if(this.rendering.glowIntensity&&(t.shadowBlur=this.rendering.glowIntensity,t.shadowColor=this.rendering.glowColor||e||i),t.beginPath(),e&&(t.strokeStyle=e),i&&(t.fillStyle=i),t.lineWidth=this.rendering.strokeWidth||1,this.components.length)for(const e of this.components)e.render(t);else for(const e of this.vertices)t.lineTo(e.x,-e.y);t.closePath(),i&&t.fill(),e&&t.stroke()}}e.default=l},149:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(694)),n=i(184),r=i(2),a=s(i(91));class l extends o.default{get bounds(){const t=this.position||this.vertices[0];return void 0===this.position&&(this.position=t),{min:new a.default(t.x-this.radius,t.y-this.radius),max:t,dimensions:this.hitbox}}get radius(){return this._radius}set radius(t){if(t<=0)throw new r.ConfigurationError("The radius of a circle must be greater than 0.");this._radius=t}get hitbox(){return new a.default(2*this.radius,2*this.radius)}get inertia(){return this.static?0:this.mass*this.radius*this.radius/2}constructor(t,e){super(t,e),this.type=n.EntityType.Circle,this._radius=0,this.radius=t.radius}rotate(){}render(t){const{stroke:e,fill:i}=this.determineColors();this.rendering.glowIntensity&&(t.shadowBlur=this.rendering.glowIntensity,t.shadowColor=this.rendering.glowColor||e||i),t.beginPath(),i&&(t.fillStyle=i),e&&(t.strokeStyle=e),t.lineWidth=this.rendering.strokeWidth||1,t.arc(this.position.x,-this.position.y,this.radius,0,2*Math.PI),t.closePath(),t.stroke(),i&&t.fill(),e&&t.stroke()}}e.default=l},184:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Colors=e.EntityType=e.Environment=e.Movement=void 0,function(t){t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right"}(e.Movement||(e.Movement={})),function(t){t[t.Browser=0]="Browser",t[t.Node=1]="Node"}(e.Environment||(e.Environment={})),function(t){t[t.Polygon=0]="Polygon",t[t.Circle=1]="Circle"}(e.EntityType||(e.EntityType={})),function(t){t.Pink="#F177DD",t.LightRed="#FC7677",t.Red="#F14E54",t.Yellow="#FFE869",t.Peach="#FCC376",t.Orange="#FFA500",t.Green="#00E16E",t.BrightGreen="#43FF91",t.NeonGreen="#8AFF69",t.Blue="#00B2E1",t.DarkBlue="#768DFC",t.Purple="#BF7FF5",t.Gray="#C0C0C0",t.Black="#000000",t.White="#FFFFFF"}(e.Colors||(e.Colors={}))},2:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigurationError=e.InternalError=void 0;class i extends Error{constructor(t){super("[SYSTEM]: Whoops, something went wrong! Please report it at our GitHub page: "+t),this.name="InternalError"}}e.InternalError=i;class s extends Error{constructor(t){super("[SYSTEM]: An error occurred when configuring an Entity or the System: "+t),this.name="ConfigurationError"}}e.ConfigurationError=s},940:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(91));e.default=class{setCenter(t){this.position.x=t.x,this.position.y=t.y}getSystemCoordinates(t){}constructor({position:t,zoom:e},i){this.position=new o.default(0,0),this.zoom=1,this.setCenter(t||new o.default(0,0)),this.zoom=e||1,this.system=i}}},544:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=i(184),o=i(2);e.default=class{constructor(t,e){if(this.framerate={fpsArr:[],fps:0,dt:0,lastUpdate:0},this.system=e,!t||!t.canvas)return;this.canvas=t.canvas;const i=this.canvas.getContext("2d");if(!i)throw new o.ConfigurationError("Could not configure Renderer: Your browser does not support CanvasRenderingContext2D.");this.context=i,window.addEventListener("resize",(()=>{this.canvas.width=window.innerWidth*window.devicePixelRatio,this.canvas.height=window.innerHeight*window.devicePixelRatio})),window.dispatchEvent(new Event("resize")),this.configure(t),requestAnimationFrame(this.render.bind(this))}configure(t){this.rendering={canvas:this.canvas,background:t.background||s.Colors.White,hooks:t.hooks||{},gridSize:t.gridSize||0,gridColor:t.gridColor||s.Colors.Black,gridWidth:t.gridWidth||1}}render(){var t,e,i,s,o,n,r,a;this.framerate.dt=performance.now()-this.framerate.lastUpdate,this.framerate.lastUpdate=performance.now(),this.framerate.fpsArr.length>30&&this.framerate.fpsArr.shift(),this.framerate.fpsArr.push(this.framerate.dt);let l=0;for(const t of this.framerate.fpsArr)l+=t;if(this.framerate.fps=Math.round(1e3/(l/this.framerate.fpsArr.length)),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.context.fillStyle=this.rendering.background,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),0!==this.rendering.gridSize){this.context.strokeStyle=this.rendering.gridColor,this.context.lineWidth=this.rendering.gridWidth;for(let t=0;t<this.canvas.width;t+=this.rendering.gridSize)this.context.beginPath(),this.context.moveTo(t,0),this.context.lineTo(t,this.canvas.height),this.context.stroke();for(let t=0;t<this.canvas.height;t+=this.rendering.gridSize)this.context.beginPath(),this.context.moveTo(0,t),this.context.lineTo(this.canvas.width,t),this.context.stroke()}this.context.strokeStyle=this.rendering.gridColor,this.context.translate(this.canvas.width/2,this.canvas.height/2),this.context.scale(this.system.camera.zoom,this.system.camera.zoom),null===(e=(t=this.rendering.hooks).preRender)||void 0===e||e.call(t,this.context);for(const t of this.system.entities)t&&(this.context.save(),null===(s=(i=t.rendering.hooks).preRender)||void 0===s||s.call(i,t,this.context),t.render(this.context),null===(n=(o=t.rendering.hooks).postRender)||void 0===n||n.call(o,t,this.context),this.context.restore());this.context.restore(),null===(a=(r=this.rendering.hooks).postRender)||void 0===a||a.call(r,this.context),requestAnimationFrame(this.render.bind(this))}}},91:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e){this.x=0,this.y=0,this.x=t,this.y=e}static toCartesian(t,e){return new i(t*Math.cos(e),t*Math.sin(e))}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return this.x*=t,this.y*=t,this}normalize(){const t=this.magnitude;return 0===t?this.x=this.y=0:(this.x/=t,this.y/=t),this}distance(t){return this.clone.subtract(t).magnitude}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}project(t){return 0===t.x&&0===t.y?new i(0,0):t.clone.scale(this.dot(t)/t.magnitudeSq)}get orthogonal(){return new i(-this.y,this.x)}angle(t={x:0,y:0}){return Math.atan2(this.y-t.y,this.x-t.x)}rotate(t){const e=this.magnitude;return this.x=e*Math.cos(t),this.y=e*Math.sin(t),this}get magnitude(){return Math.sqrt(this.magnitudeSq)}set magnitude(t){const e=this.angle();this.x=t*Math.cos(e),this.y=t*Math.sin(e)}get magnitudeSq(){return this.x*this.x+this.y*this.y}get clone(){return new i(this.x,this.y)}}e.default=i}},e={};(function i(s){var o=e[s];if(void 0!==o)return o.exports;var n=e[s]={exports:{}};return t[s].call(n.exports,n,n.exports,i),n.exports})(296)})();